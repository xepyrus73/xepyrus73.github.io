<html>
<head>
<title>General Linear Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=euc-kr">
<script language="JavaScript" src="test.js"></script>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" onLoad="MM_preloadImages('images/b_basic_on.gif','images/b_pro01_on.gif')">
<style><!--
.leading200 { line-height: 200% }
.leading180 { line-height: 180% }
.leading150 { line-height: 150% }
.leading100 { line-height: 100% }
-->
</style>
<table border=0 cellpadding=0 cellspacing=0 width=580>
  <tr> 
    <td width=20 height="2511">&nbsp;</td>
    <td height="2511"> 
      <table border=0 cellpadding=0 cellspacing=0 width=560>
        <tr> 
          <td height="153"> 
            <div align="left">
              <p><a href="anovaglm.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image19','','images/b_basic_on.gif',1)"><img name="Image19" border="0" src="images/B_basic.gif" width="55" height="24"></a><a href="#" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image18','','images/b_pro01_on.gif',1)"><img name="Image18" border="0" src="images/B_pro01.gif" width="55" height="24"></a><br>
                <BR>
                <font size="4" color="#a70105"><b> <font color="#a70105">General 
                Linear Model</font></b></font> </p>
              <p><font size="3"><b>Stat&gt;ANOVA&gt;General Linear Model</b></font><br>
                <br>
                <font size="-1">General Linear Model은 다수의 인자로 이루어진 여러 모형(모수모형, 
                혼합모형 등)을 분석할 수 있으며 균형설계 데이터와 불균형설계 데이터를 모두 분석할 수 있다. 또한, ANOVA와 
                회귀분석을 결합한 분산분석으로 회귀분석의 독립변수에 해당하는 인자를 공변량(Covariate)으로 지정하여 측정값의 
                총변동을 공변량의 1차 효과, 2차 효과 등 고차원 효과로 분해하는 등 좀더 심도있는 분석을 수행할 수 있다.<br>
                <br>
                <font size="2"><b><br>
                1. MINITAB을 사용한 General Linear Model <a href="data/Anova06.zip">(데이터 
                : Anova06.mtw)</a></b></font><br>
                <br>
                특정 화학 제품을 압력관(Pressure vessel)에 통과시켜 생산하고 있다. 이 제품의 여과율(Filtration 
                rate)에 대한 공정 요인들의 영향을 평가하기 위해 공정온도 2수준, 포름알데히드 농도 3수준에서 반복 3회씩 
                실험을 한 결과 여과율에 대한 데이터가 다음과 같다. 분산분석을 실시하려고 한다.<br>
                <br>
                <img src="images/AnovaGLM2_01.gif" width="378" height="193"><br>
                <br>
                <br>
                1.1 데이터의 입력<br>
                &nbsp;&nbsp;&nbsp;&nbsp;Worksheet에 아래의 데이터를 입력한다.<br>
                <br>
                <img src="images/AnovaGLM2_02.gif" width="261" height="403"><br>
                <br>
                <br>
                1.2 <a href="equal_var.htm">등분산성을 검정한다.</a><br>
                <br>
                <br>
                1.3 <a href="normaltest.html">정규성을 검정한다.</a> <br>
                <br>
                <br>
                1.4 <a href="intervalplot2.htm">Interval Plot을 그려본다.</a><br>
                <br>
                <br>
                1.5 <a href="maineffect2.htm">Main Effects Plot을 그려 본다.</a><br>
                <br>
                <br>
                1.6 <a href="interactionplot2.htm">Interactions Plot을 그려 본다.</a><br>
                <br>
                <br>
                1.7 분산분석을 실시한다.<br>
                <br>
                ① Stat > ANOVA > General Linear Model...<br>
                <br>
                <img src="images/AnovaGLM2_03.gif" width="515" height="301"><br>
                <br>
                <br>
                <br>
                ② Responses란에 '여과율'을 입력한다. 교호작용은 Interaction plot에서 별 의미가 <br>
                &nbsp;&nbsp;&nbsp;없었으므로 모든 인자에 대한 주효과만 분석하므로 Model란에 '온도' 와 <br>
                &nbsp;&nbsp;'농도'를 입력한다. <br>
                <br>
                <img src="images/AnovaGLM2_05.gif" width="487" height="343"> <br>
                <br>
                Model란에는 분석하고자 하는 모델의 형태를 나타내는데 항(Term)을 사용한다. 각 주효과에 대해서는 인자 
                명이 그 주효과의 항이 되고 교호작용의 경우 인자의 곱으로 나타내는 것이 교호작용의 항이 된다. 예를 들어 인자 
                A와 B의 수준이 대응되어 실험이 일어난다면 통계적 모델은 다음과 같다. <br>
                <img src="images/AnovaGLM2_06.gif" width="295" height="32"><br>
                <br>
                여기서 모델에 대한 항(Term)은 A, B, A*B가 될 것이다. 다르게 표현하면 A | B로 표현할 수도 있다. 
                이 것은 A와 B사이에 있는 모든 교호작용을 포함한다는 것이다. <br>
                Random factor 란은 인자 중에서 변량인자가 있을 경우에 입력하는 것이다.<br>
                <br>
                <br>
                ③ Covariates...를 클릭한다.<br>
                <br>
                <img src="images/AnovaGLM2_07.gif" width="525" height="314"> <br>
                <br>
                실험결과 분석 시 인자가 공변량(Covariate)일 경우 지정하여 분석할 때 사용하는 옵션이다. 본 예에서는 
                공변량이 없다. <br>
                <br>
                ■ 공변량 (Covariate) <br>
                &nbsp;&nbsp;&nbsp;통제되지않는 정량적인 변수이다. 비록, 통제는 되지 않지만 오차분산을 줄이기 위해 
                모델에 &nbsp;&nbsp;&nbsp;포함시킨다.<br>
                <br>
                <br>
                ④ Options...를 클릭한다.<br>
                <br>
                <img src="images/AnovaGLM2_08.gif" width="563" height="264"><br>
                <br>
                Do a weighted fit, using weights in란은 가중값으로 사용할 변수 열 있을 때 지정한다. 
                그러면 모델의 각 항(term)에 가중값을 주어 적합값을 구해준다. <br>
                <br>
                Sum of Squares에서<br>
                Sequential(Type I)의 경우 단계적 회귀분석을 하는 방법으로 Model 문에 지정된 순서대로 인자가 
                모델에 하나씩 추가 되면서 회귀분석이 실시된다. <br>
                Adjusted(Type III)의 경우 동시에 회귀분석을 하는 방법으로 한 인자의 효과가 검증될 때 다른 모든 
                인자의 효과와 중복된 부분은 제거된 상태에서 검증된다. <br>
                <br>
                <br>
                ⑤ Comparisons...를 클릭한다.<br>
                <br>
                <img src="images/AnovaGLM2_09.gif" width="565" height="290"><br>
                <br>
                다중비교를 하는데 있어서 Pairwise comparisons를 선택하면 각 수준별로 비교를 하려고 한다. Comparisons 
                with a control을 선택하면 특정한 인자의 수준을 정하고 2수준과 비교할 때 선택한다. Comparisons 
                with a control을 선택하면 다중 비교의 방법 중 Dunnet을 지정할 수 있다. <br>
                Term은 다중비교를 하는 항을 지정한다. 본 예에서는 '온도'에 대해서만 하기로 하고 그 방법으로는 Tukey를 
                선택했다. <br>
                </font> </p>
            </div>
            <ul>
              <li><font size="-1"><b>Tukey's</b> : 모든 수준별 평균의 차이를 비교한다. <br>
                </font> 
              <li><b><font size="-1">Dunnett's</font></b><font size="-1"> : 특정한 
                수준을 정해 놓고 평균의 차이를 비교한다.<br>
                </font> 
              <li><font size="-1"><b>Bonferron</b>i: 확률한계를 이용하여 평균의 차이를 비교한다. 
                이 방법은 다른 방법에 비해 가장 보수적이다. 여기서 보수적이란 의미는 실제 오류 율이 주어진 오류 율이 보다 
                항상 작음을 의미한다.<br>
                </font>
               
              <li><font size="-1"><b>Sidak</b>: 확률한계를 이용하여 평균의 차이를 비교한다.</font>
            </ul>
                <br>
                <br>
            <font size="-1">Alternative는 대립가설을 나타낸다. 대립가설은 "작다", "다르다", "크다"의 
            세가지 형태로 지정할 수 있다.<br>
            <br>
            Confidence interval, with confidence level 란은 신뢰구간을 구할 신뢰수준을 얼마로 할지를 
            지정한다. 본 예에서는 95%로 하기 위하여 95.0을 입력한다. 또한 Test를 선택하여 다중 비교 가설 검정 결과를 
            출력한다.<br>
            <br>
            <br>
            ⑥ Graphs...를 클릭한다.<br>
            <br>
            <img src="images/AnovaGLM2_10.gif" width="524" height="363"><br>
            <br>
            잔차 분석을 위한 그래프를 선택한다. <br>
            <br>
            Residuals for Plots에서<br>
            Regular : 일반적인 잔차를 구하는 방식으로 관측값과 적합값의 차이값이다.<br>
            Standardized : 잔차를 표준화 시킨 잔차이다.<br>
            Deleted : 적합값을 구할 때 자신의 값을 제외하고 구한 후에 관측값과의 차이값을 구한다.<br>
            <br>
            <br>
            <b>◆ 잔차에 대한 그래프 분석</b><br>
            <br>
            잔차를 분석하는 이유는 다음과 같다.<br>
            </font> 
            <ul>
              <li><font size="-1">실험변동이 단지 우연원인에 의한 것인지를 확인하기 위함</font> 
              <li><font size="-1">결론에 중대한 영향을 줄 수 있는 잠재변수를 찾기 위함 </font>
            </ul>
            <p><font size="-1">잔차는 정규성을 따라야 결과치가 올바로 분석된 것으로 판단할 수 있다. 즉 잔차가 정규분포를 
              따르면 실험변동이 랜덤하다는 것을 나타낸다.<br>
              <br>
              <br>
              <b>Graph 창에 나타난 결과 : Histogram of residuals</b><br>
              <br>
              <img src="images/AnovaGLM2_11.gif" width="342" height="255"><br>
              <br>
              잔차의 히스토그램으로 전반적인 잔차의 형태를 나타내는데 잔차의 형태가 정규분포를 따름을 알 수 있다.<br>
              <br>
              <b><br>
              Graph 창에 나타난 결과 : Normal plot of residuals</b><br>
              <br>
              <img src="images/AnovaGLM2_12.gif" width="358" height="267"> <br>
              <br>
              잔차를 정규확률 plot을 하여 잔차들이 정규분포를 따르는지를 알아보는 방법이다. 잔차들을 타점해본 결과 대부분의 
              점들이 일직선상에 위치 함으로 정규분포를 따른다.<br>
              <b><br>
              <br>
              Graph 창에 나타난 결과 : Residuals versus fits</b><br>
              <br>
              <img src="images/AnovaGLM2_13.gif" width="344" height="257"> <br>
              <br>
              :잔차와 적합값에 대한 그림으로 적합값이 0 근처에 랜덤하게 타점 될수록 실험변동이 단지 우연원인에 의한 것임을 나타낸다.<br>
              <br>
              <b><br>
              Graph 창에 나타난 결과 : Residuals versus order</b><br>
              <br>
              <img src="images/AnovaGLM2_14.gif" width="356" height="266"> <br>
              <br>
              데이터 순서에 따른 잔차 그림으로 잔차값들이 0을 중심으로 랜덤하게 배열되어 있다.<br>
              <br>
              <b>☞ 기타 : Residuals versus the variables</b><br>
              선택한 변수와 잔차에 대한 그림을 그리는데 점들이 0 근처에 랜덤하게 타점될 수록 실험변동이 단지 우연 원인에 의한 
              것임을 나타낸다.<br>
              <br>
              잔차 분석은 결과분석이 올바르게 분석된 것인지를 판단하는데 중요한 역할을 한다. 위의 모든 그래프를 보아 실험변동은 
              단지 우연원인에 의한 것이다. 따라서 분석결과에 통계적 신뢰성을 확보할 수 있다.<br>
              <br>
              <br>
              ⑦ Results...을 클릭한다. <br>
              <br>
              <img src="images/AnovaGLM2_15.gif" width="516" height="346"> <br>
              <br>
              Display of Result에서는 선택한 부분에 대하여 Session창에 출력한다.<br>
              Analysis of variance table : 분산분석표<br>
              Coefficient for covariate terms : 공변량에 대한 계수를 출력한다.<br>
              Table of unusual observations : 이상치가 있을 경우 출력한다.<br>
              Coefficients for all terms : 모든 항의 계수를 출력한다.<br>
              <br>
              Display expected mean squares and variance component를 선택하면 Session창에 
              분산성분과 평균제곱의 기대값을 출력한다. <br>
              <br>
              각 항(term)에 대한 최소 제곱 평균값을 구하고 싶으면 Display least squares means corresponding 
              to the terms항에 항(term)을 입력하면 된다. 본 예에서는 "C1 온도","C2 농도"이다. <br>
              <br>
              ⑧ Storage...를 클릭한다.<br>
              <br>
              <img src="images/AnovaGLM2_16.gif" width="546" height="176"> <br>
              <br>
              Worksheet에 저장할 결과를 지정할 수 있는데 <br>
              Diagnostic Measures :잔차(Residuals, Standardized residuals, Deleted 
              t residuals), 이상치에 대하여(Hi, Cook's distance, DFITS)에 대하여 출력한다. 이상치를 
              구하는 구체적인 방법(Hi, Cook's distance, DFITS)은 통계적으로 상당히 어렵기 때문에 자세한 설명은 
              생략한다. 이 옵션을 사용할 때는 이들 방법 중에 한 두 가지를 선택하여 사용할 것을 추천한다.<br>
              Characteristics of Estimated Equation: 모델을 구성하는 계수(Coefficients), 
              적합값(Fits)과 실험계획 매트릭스(Design matrix)가 각각의 반응치에 대해 저장된다. <br>
              <br>
              <br>
              ⑧ Factorial Plot...을 클릭한다.<br>
              <br>
              <img src="images/AnovaGLM2_17.gif" width="566" height="332"><br>
              <br>
              주효과 Plot과 교호작용 Plot을 그리는 옵션으로 구하고자 하는 요인을 입력한다.<br>
              Display full interaction plot matrix를 지정하여 교호작용 plot이 매트릭스 형태로 나오게 
              한다. Minimum for Y(response) scale 와 Maximum for Y(response) scale은 
              반응값의 최소, 최대 척도를 정해준다. 또한, Title란에는 Plot의 제목을 입력할 수가 있다. <br>
              결과물에 대해서는 이미 Main Effects plot과 Interactions Plot에서 제시하였으므로 참조하기 
              바란다.(동일한 결과물을 얻을 수 있다. 즉 General Linear Model에서도 Main Effects plot과 
              Interactions Plot을 Factorial plot 옵션을 지정하여 얻을 수 있다.) <br>
              <br>
              <br>
              ⑨ OK 버튼을 클릭한다.<br>
              <br>
              <b>Session 창에 나타난 결과 : 분산분석표</b><br>
              <br>
              <img src="images/AnovaGLM2_18.gif" width="486" height="397"> <br>
              <br>
              DF : 자유도 (Degree of Freedom) <br>
              SS : 제곱합 (Square of Sum)<br>
              MS : 평균 제곱합 (Mean of Square)<br>
              F : 검정 통계량의 값<br>
              P : P-value(유의확률)<br>
              <br>
              위 결과에서 온도 인자에 대한 P-value가 0.000이므로 유의수준 5%에서 온도의 수준의 변화에 따라 차이가 
              없다라는 귀무가설을 기각한다. 즉, 온도에 의해 여과율이 차이가 있다는 결론을 내린다.<br>
              Unusual Observations for 여과율은 이상치의 값을 출력해준다. 본 예에서는 18번째의 관측치가 실제값(8.9)과 
              적합값(19.2444)이 큰 차이가 남을 알 수 있다. <br>
              <br>
              <img src="images/AnovaGLM2_19.gif" width="473" height="478"> <br>
              <br>
              <b><1></b> 각 항(term)에 대한 평균제곱(MS)에 대한 기대값을 나타낸다. 예를 들어 온도의 MS의 기대값은 
              (3) + Q[1]이다. 여기서 (3)은 Error를 나타내고, Q[1]= 온도의 분산이다. <br>
              <b><2></b> 분산성분의 경우 변량인자가 없으므로 모두 오차항(Error Term)으로 나누어 F값을 구한다. 
              예를 들어 온도의 경우 Error term이 3임을 알 수 있다. 이는 온도의 MS를 3에 해당하는 Error의 MS로 
              나누어 F값을 구한다는 의미이다. 즉 F = 온도 MS / Error의 MS이다. <br>
              <b><3></b> 온도가 100도 일 때 여과율이 20.056으로 온도가 50일 때 보다 더 높다.<br>
              <b><br>
              Session 창에 나타난 결과 : 다중 비교</b><br>
              <br>
              <img src="images/AnovaGLM2_20.gif" width="562" height="251"><br>
              <br>
              온도에 대한 각 수준( 50도와 100도)의 차이가 있는지를 알아본다. 두 수준의 평균의 차이(Difference 
              of Mean)에 대한 95%신뢰구간은 (6.432 16.68)로 0을 포함하지 않으므로 유의하다. Test결과 P-Value가 
              0.0003으로 유의수준 0.05에서 유의함을 알 수 있다. </font> </p>
            </td>
        </tr>
        <tr> 
          <td> <br>
            <hr size=1 color=#C0BDD6 width=90% align=center>
            <div align="center"><img src="images/copy.gif" width="271" height="26"> 
              <br>
            </div>
          <br>
          </td>
        </tr>
      </table>
  </tr>
</table>
</body>
</html>
